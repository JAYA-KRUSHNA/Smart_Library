{% extends "base.html" %}
{% set background = 'https://images.unsplash.com/photo-1507842217343-583bb7270b66' %}
{% block content %}
<div class="container">
    <h1 class="text-center mb-4">üìñ Records for {{ student.regno }} ({{ student.email }})</h1>

    {% if borrowed_books %}
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Book Name</th>
                <th>Borrow Date</th>
                <th>Due Date</th>
                <th>Return Date</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for book in borrowed_books %}
            <tr>
                <td>{{ book.book_name }}</td>
                <td>{{ book.borrow_date.strftime('%Y-%m-%d') }}</td>
                <td>{{ book.due_date.strftime('%Y-%m-%d') }}</td>
                <td>
                    {% if book.actual_return_date %}
                        {{ book.actual_return_date.strftime('%Y-%m-%d') }}
                    {% else %}
                        Not Returned
                    {% endif %}
                </td>
                <td>
                    {% if book.actual_return_date %}
                        <span class="status-returned">Returned</span>
                    {% elif book.due_date < today_date %}
                        <span class="status-overdue">Overdue</span>
                    {% else %}
                        <span class="status-borrowed">Borrowed</span>
                    {% endif %}
                </td>
                <td>
                    {% if not book.actual_return_date %}
                        <a href="{{ url_for('edit_due', borrowed_book_id=book.id) }}" class="btn btn-warning btn-sm">Edit Due</a>
                    {% else %}
                        N/A
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center lead">No borrowing history found for this student.</p>
    {% endif %}

    <div class="text-center mt-4">
        <a href="{{ url_for('admin_panel') }}" class="btn btn-secondary">‚¨ÖÔ∏è Back to Admin Panel</a>
    </div>
</div>
{% endblock %}